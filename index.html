<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŠ¤ë§ˆíŠ¸ ì—…ë¬´ ìŠ¤ì¼€ì¤„ëŸ¬</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #40c057;
            --primary-hover: #37b24d;
            --bg: #f1f3f5;
            --text: #212529;
        }

        body {
            font-family: 'Pretendard', -apple-system, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 15px;
        }

        .container { max-width: 1000px; margin: 0 auto; }

        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            padding: 25px;
            margin-bottom: 20px;
        }

        h2 {
            margin: 0 0 20px 0;
            font-size: 22px;
            color: #495057;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .input-group { display: flex; flex-direction: column; gap: 6px; }

        label { font-size: 14px; font-weight: 600; color: #868e96; }

        input, textarea {
            padding: 12px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            font-size: 15px;
            transition: border-color 0.2s;
            font-family: inherit;
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(64,192,87,0.15);
        }

        button#submitBtn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 14px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
            transition: background 0.2s;
        }

        button#submitBtn:hover:not(:disabled) { background: var(--primary-hover); }
        button#submitBtn:disabled { background: #adb5bd; cursor: not-allowed; }

        /* ì•Œë¦¼ í† ìŠ¤íŠ¸ */
        #toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(80px);
            background: #343a40;
            color: white;
            padding: 14px 28px;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 500;
            z-index: 9999;
            transition: transform 0.3s ease;
            pointer-events: none;
        }
        #toast.show { transform: translateX(-50%) translateY(0); }
        #toast.success { background: #40c057; }
        #toast.error { background: #fa5252; }

        /* ë””ë²„ê·¸ íŒ¨ë„ */
        #debugPanel {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 12px 16px;
            margin-top: 12px;
            font-size: 13px;
            color: #495057;
            display: none;
        }
        #debugPanel.visible { display: block; }
        #debugLog { max-height: 120px; overflow-y: auto; font-family: monospace; font-size: 12px; }
        .log-item { padding: 3px 0; border-bottom: 1px solid #e9ecef; }
        .log-ok { color: #40c057; }
        .log-err { color: #fa5252; }
        .log-info { color: #228be6; }

        /* í…Œì´ë¸” */
        .table-container { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 14px; margin-top: 10px; }
        th { background: #f8f9fa; padding: 12px; text-align: left; border-bottom: 2px solid #dee2e6; color: #495057; }
        td { padding: 12px; border-bottom: 1px solid #f1f3f5; vertical-align: middle; }
        tr:hover td { background: #f8fff9; }

        .status-badge {
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            cursor: pointer;
            border: 1px solid transparent;
            display: inline-block;
            text-align: center;
            font-weight: 600;
        }
        .status-none { background: #fff5f5; color: #fa5252; border-color: #ffc9c9; }
        .status-none:hover { background: #ffe3e3; }
        .status-done { background: #ebfbee; color: #40c057; border-color: #b2f2bb; cursor: default; }

        #loading {
            text-align: center;
            padding: 20px;
            font-size: 14px;
            color: #868e96;
            display: none;
        }

        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            flex-wrap: wrap;
            gap: 8px;
        }

        .toolbar-btn {
            background: none;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 6px 12px;
            font-size: 13px;
            cursor: pointer;
            color: #495057;
            transition: all 0.2s;
        }
        .toolbar-btn:hover { background: #f1f3f5; border-color: #adb5bd; }
        .toolbar-btn.active { background: #e8f5e9; border-color: var(--primary); color: var(--primary); }
    </style>
</head>
<body>

<div id="toast"></div>

<div class="container">
    <div class="card">
        <h2><i class="fas fa-edit"></i> êµ¬ë¡€ì¤‘ ì‹ ê·œ ì—…ë¬´ ë“±ë¡</h2>
        <form id="scheduleForm">
            <div class="form-grid">
                <div class="input-group">
                    <label for="docNum">ê³µë¬¸ë²ˆí˜¸</label>
                    <input type="text" id="docNum" name="docNum" placeholder="ì˜ˆ: ì¤‘ë“±êµìœ¡ê³¼-123(2026.2.1.)" required>
                </div>
                <div class="input-group">
                    <label for="title">ê³µë¬¸ì œëª©</label>
                    <input type="text" id="title" name="title" placeholder="ì œì¶œí•  ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”" required>
                </div>
                <div class="input-group">
                    <label for="dueDate">ì œì¶œë§ˆê°ì¼</label>
                    <input type="date" id="dueDate" name="dueDate" required>
                </div>
            </div>
            <div class="input-group" style="margin-bottom: 20px;">
                <label for="memo">ë¹„ê³ </label>
                <textarea id="memo" name="memo" rows="2" placeholder="ë©”ëª¨í•  ì‚¬í•­ì´ ìˆìœ¼ë©´ ì…ë ¥í•˜ì„¸ìš”"></textarea>
            </div>
            <button type="submit" id="submitBtn">
                <i class="fas fa-plus-circle"></i> ì—…ë¬´ ë“±ë¡í•˜ê¸°
            </button>
        </form>

        <!-- ë””ë²„ê·¸ íŒ¨ë„ -->
        <div id="debugPanel">
            <strong>ğŸ” í†µì‹  ë¡œê·¸</strong>
            <div id="debugLog"></div>
        </div>
    </div>

    <div class="card">
        <div class="toolbar">
            <h2 style="margin:0;"><i class="fas fa-list-check"></i> ì—…ë¬´ ì¶”ì§„ í˜„í™© (ë§ˆê° ìˆœ)</h2>
            <div style="display:flex;gap:8px;flex-wrap:wrap;">
                <button class="toolbar-btn" id="filterAll" onclick="setFilter('all')">ì „ì²´</button>
                <button class="toolbar-btn" id="filterPending" onclick="setFilter('pending')">ë¯¸ì œì¶œ</button>
                <button class="toolbar-btn" id="filterDone" onclick="setFilter('done')">ì™„ë£Œ</button>
                <button class="toolbar-btn" onclick="fetchAndDisplayData()"><i class="fas fa-rotate-right"></i> ìƒˆë¡œê³ ì¹¨</button>
                <button class="toolbar-btn" id="debugBtn" onclick="toggleDebug()"><i class="fas fa-bug"></i> ë””ë²„ê·¸</button>
            </div>
        </div>
        <div id="loading"><i class="fas fa-spinner fa-spin"></i> ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ìˆìŠµë‹ˆë‹¤...</div>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>ì—°ë²ˆ</th>
                        <th>ê³µë¬¸ë²ˆí˜¸</th>
                        <th>ê³µë¬¸ì œëª©</th>
                        <th>ì œì¶œì¼(ì™„ë£Œ)</th>
                        <th>ë§ˆê°ê¸°í•œ</th>
                        <th>ë¹„ê³ </th>
                    </tr>
                </thead>
                <tbody id="scheduleList"></tbody>
            </table>
        </div>
    </div>
</div>

<script>
    // âœ… Apps Script ë°°í¬ URL
    const scriptURL = 'https://script.google.com/macros/s/AKfycbxSZyQ0XtvsUfcleUTv5fWb9LeXPKRJR7f8I9t7vzj-g0fxNEKyupYUphWejA9PUIWd/exec';

    let allData = [];
    let currentFilter = 'all';
    let debugVisible = false;

    // â”€â”€ í† ìŠ¤íŠ¸ ì•Œë¦¼ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function showToast(msg, type = '') {
        const t = document.getElementById('toast');
        t.textContent = msg;
        t.className = type ? `show ${type}` : 'show';
        setTimeout(() => { t.className = ''; }, 3000);
    }

    // â”€â”€ ë””ë²„ê·¸ ë¡œê·¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function log(msg, type = 'info') {
        const el = document.getElementById('debugLog');
        const d = document.createElement('div');
        d.className = `log-item log-${type}`;
        d.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
        el.prepend(d);
        console.log(`[Scheduler] ${msg}`);
    }

    function toggleDebug() {
        debugVisible = !debugVisible;
        document.getElementById('debugPanel').classList.toggle('visible', debugVisible);
        document.getElementById('debugBtn').classList.toggle('active', debugVisible);
    }

    // â”€â”€ JSONP í†µì‹  (íƒ€ì„ì•„ì›ƒ ì¶”ê°€) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function jsonpRequest(params, timeoutMs = 15000) {
        return new Promise((resolve, reject) => {
            const callbackName = 'cb_' + Date.now() + '_' + Math.floor(Math.random() * 10000);

            const timer = setTimeout(() => {
                cleanup();
                reject(new Error('ìš”ì²­ ì‹œê°„ ì´ˆê³¼ (15ì´ˆ). ì„œë²„ ì‘ë‹µì´ ì—†ìŠµë‹ˆë‹¤.'));
            }, timeoutMs);

            function cleanup() {
                clearTimeout(timer);
                delete window[callbackName];
                if (script.parentNode) document.body.removeChild(script);
            }

            window[callbackName] = function(data) {
                cleanup();
                resolve(data);
            };

            const script = document.createElement('script');
            let url = scriptURL + '?callback=' + callbackName;
            for (const key in params) {
                url += `&${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`;
            }
            log(`ìš”ì²­: action=${params.action}`, 'info');
            script.src = url;
            script.onerror = () => {
                cleanup();
                reject(new Error('ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì‹¤íŒ¨. URL ë˜ëŠ” ë„¤íŠ¸ì›Œí¬ë¥¼ í™•ì¸í•˜ì„¸ìš”.'));
            };
            document.body.appendChild(script);
        });
    }

    // â”€â”€ í•„í„° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function setFilter(f) {
        currentFilter = f;
        ['All','Pending','Done'].forEach(k => {
            document.getElementById('filter'+k).classList.remove('active');
        });
        document.getElementById('filter' + f.charAt(0).toUpperCase() + f.slice(1)).classList.add('active');
        renderTable(allData);
    }

    // â”€â”€ í…Œì´ë¸” ë Œë”ë§ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function renderTable(data) {
        const tbody = document.getElementById('scheduleList');
        tbody.innerHTML = '';

        let filtered = data;
        if (currentFilter === 'pending') filtered = data.filter(r => !r.submitDate || r.submitDate.toString().trim() === '');
        if (currentFilter === 'done')    filtered = data.filter(r => r.submitDate && r.submitDate.toString().trim() !== '');

        if (filtered.length === 0) {
            tbody.innerHTML = `<tr><td colspan="6" style="text-align:center;color:#adb5bd;padding:30px;">
                <i class="fas fa-inbox" style="font-size:24px;display:block;margin-bottom:8px;"></i>
                í‘œì‹œí•  ì—…ë¬´ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>`;
            return;
        }

        filtered.forEach((row, index) => {
            const tr = document.createElement('tr');
            const isSubmitted = row.submitDate && row.submitDate.toString().trim() !== '';

            // ë§ˆê° ì„ë°• ê°•ì¡° (ì˜¤ëŠ˜ ê¸°ì¤€ 3ì¼ ì´ë‚´, ë¯¸ì™„ë£Œ)
            let dueCss = '';
            if (!isSubmitted && row.dueDate) {
                const diff = (new Date(row.dueDate) - new Date()) / 86400000;
                if (diff < 0)       dueCss = 'color:#e03131;font-weight:bold;'; // ì´ˆê³¼
                else if (diff <= 3) dueCss = 'color:#f76707;font-weight:bold;'; // ì„ë°•
                else                dueCss = 'color:#e03131;font-weight:bold;';
            }

            tr.innerHTML = `
                <td style="color:#adb5bd;">${index + 1}</td>
                <td style="font-size:13px;">${row.docNum || ''}</td>
                <td><strong>${row.title || ''}</strong></td>
                <td>
                    ${isSubmitted
                        ? `<span class="status-badge status-done"><i class="fas fa-check"></i> ${row.submitDate}</span>`
                        : `<button class="status-badge status-none" onclick="updateDate(${row.rowNum}, '${(row.title||'').replace(/'/g,"\\'")}')">
                             <i class="fas fa-clock"></i> ë¯¸ì œì¶œ (ì…ë ¥)
                           </button>`
                    }
                </td>
                <td style="${dueCss}">${row.dueDate || ''}</td>
                <td style="color:#868e96;font-size:12px;">${row.memo || '-'}</td>
            `;
            tbody.appendChild(tr);
        });
    }

    // â”€â”€ ë°ì´í„° ì¡°íšŒ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function fetchAndDisplayData() {
        const loading = document.getElementById('loading');
        loading.style.display = 'block';
        log('ë°ì´í„° ì¡°íšŒ ì‹œì‘...', 'info');

        try {
            const data = await jsonpRequest({ action: 'read' });
            log(`ë°ì´í„° ìˆ˜ì‹ : ${JSON.stringify(data).slice(0, 80)}...`, 'ok');

            // ì‘ë‹µì´ ë°°ì—´ì¸ì§€ í™•ì¸
            if (!Array.isArray(data)) {
                throw new Error(`ì‘ë‹µì´ ë°°ì—´ì´ ì•„ë‹™ë‹ˆë‹¤: ${JSON.stringify(data)}`);
            }

            // ë§ˆê°ì¼ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬
            data.sort((a, b) => new Date(a.dueDate || '9999-12-31') - new Date(b.dueDate || '9999-12-31'));
            allData = data;
            renderTable(allData);
            log(`ì´ ${data.length}ê±´ ë Œë”ë§ ì™„ë£Œ`, 'ok');

        } catch (e) {
            log(`ì¡°íšŒ ì‹¤íŒ¨: ${e.message}`, 'err');
            document.getElementById('scheduleList').innerHTML =
                `<tr><td colspan="6" style="text-align:center;color:#fa5252;padding:20px;">
                    <i class="fas fa-triangle-exclamation"></i> ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨<br>
                    <small style="color:#adb5bd;">${e.message}</small><br>
                    <small style="color:#adb5bd;">Apps Script ë°°í¬ ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš” (ì•„ë˜ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì°¸ê³ )</small>
                </td></tr>`;
            showToast('ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ' + e.message, 'error');
            // ì‹¤íŒ¨ì‹œ ë””ë²„ê·¸ íŒ¨ë„ ìë™ ì—´ê¸°
            if (!debugVisible) toggleDebug();
        } finally {
            loading.style.display = 'none';
        }
    }

    // â”€â”€ ì—…ë¬´ ë“±ë¡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.getElementById('scheduleForm').onsubmit = async function(e) {
        e.preventDefault();

        const btn = document.getElementById('submitBtn');
        btn.disabled = true;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ì„œë²„ì— ì €ì¥ ì¤‘...';

        const formData = new FormData(e.target);
        const params = { action: 'create' };
        formData.forEach((value, key) => { params[key] = value; });

        log(`ë“±ë¡ ì‹œë„: ${JSON.stringify(params)}`, 'info');

        try {
            const res = await jsonpRequest(params);
            log(`ë“±ë¡ ì‘ë‹µ: ${JSON.stringify(res)}`, 'ok');

            // âœ… ìˆ˜ì •: ì‘ë‹µ í˜•íƒœê°€ ë‹¤ì–‘í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ìœ ì—°í•˜ê²Œ ì²˜ë¦¬
            const isSuccess = res && (
                res.status === 'success' ||
                res.result === 'success' ||
                res.message === 'success' ||
                res.ok === true
            );

            if (isSuccess) {
                showToast('âœ… ì—…ë¬´ê°€ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                e.target.reset();
                await fetchAndDisplayData();
            } else {
                // ì„œë²„ê°€ ì‘ë‹µí–ˆì§€ë§Œ ì„±ê³µ ì‹ í˜¸ê°€ ì—†ëŠ” ê²½ìš° â€” ê·¸ë˜ë„ ìƒˆë¡œê³ ì¹¨ ì‹œë„
                log(`ê²½ê³ : ì˜ˆìƒì¹˜ ëª»í•œ ì‘ë‹µ í˜•íƒœ â†’ ${JSON.stringify(res)}`, 'err');
                showToast('ë“±ë¡ëì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ëª©ë¡ì„ í™•ì¸í•˜ì„¸ìš”.', '');
                e.target.reset();
                await fetchAndDisplayData();
            }
        } catch (err) {
            log(`ë“±ë¡ ì‹¤íŒ¨: ${err.message}`, 'err');
            showToast('ë“±ë¡ ì‹¤íŒ¨: ' + err.message, 'error');
            if (!debugVisible) toggleDebug();
        } finally {
            btn.disabled = false;
            btn.innerHTML = '<i class="fas fa-plus-circle"></i> ì—…ë¬´ ë“±ë¡í•˜ê¸°';
        }
    };

    // â”€â”€ ì œì¶œì¼ ì—…ë°ì´íŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function updateDate(rowNum, title) {
        const today = new Date().toISOString().split('T')[0];
        const date = prompt(`[${title}] ì œì¶œ ì™„ë£Œ ë‚ ì§œë¥¼ ì…ë ¥í•˜ì„¸ìš” (YYYY-MM-DD)`, today);
        if (!date) return;

        // ë‚ ì§œ í˜•ì‹ ê°„ë‹¨ ê²€ì¦
        if (!/^\d{4}-\d{2}-\d{2}$/.test(date)) {
            showToast('ë‚ ì§œ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. (ì˜ˆ: 2026-01-15)', 'error');
            return;
        }

        log(`ì—…ë°ì´íŠ¸ ì‹œë„: rowNum=${rowNum}, date=${date}`, 'info');
        try {
            const res = await jsonpRequest({ action: 'update', rowNum: rowNum, submitDate: date });
            log(`ì—…ë°ì´íŠ¸ ì‘ë‹µ: ${JSON.stringify(res)}`, 'ok');

            const isSuccess = res && (
                res.status === 'success' ||
                res.result === 'success' ||
                res.ok === true
            );

            if (isSuccess) {
                showToast('âœ… ì œì¶œ ë‚ ì§œê°€ ê¸°ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            } else {
                showToast('ì²˜ë¦¬ëì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ëª©ë¡ì„ í™•ì¸í•˜ì„¸ìš”.', '');
            }
            await fetchAndDisplayData();
        } catch (err) {
            log(`ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: ${err.message}`, 'err');
            showToast('ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: ' + err.message, 'error');
            if (!debugVisible) toggleDebug();
        }
    }

    // â”€â”€ ì´ˆê¸°í™” â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.getElementById('filterAll').classList.add('active');
    window.onload = fetchAndDisplayData;
</script>

<!-- âœ… Apps Script ì²´í¬ë¦¬ìŠ¤íŠ¸ (ê°œë°œììš© ë©”ëª¨) -->
<!--
[Apps Script ë°°í¬ ì„¤ì • í™•ì¸ì‚¬í•­]
1. ë°°í¬ > ì›¹ ì•±ìœ¼ë¡œ ë°°í¬ > ì•¡ì„¸ìŠ¤: "ëª¨ë“  ì‚¬ìš©ì" (ìµëª… í¬í•¨) ë¡œ ì„¤ì •ë˜ì–´ ìˆì–´ì•¼ í•¨
2. ì½”ë“œ ìˆ˜ì • í›„ ë°˜ë“œì‹œ "ìƒˆ ë°°í¬"ê°€ ì•„ë‹Œ "ê¸°ì¡´ ë°°í¬ ì—…ë°ì´íŠ¸" í•´ì•¼ URLì´ ìœ ì§€ë¨
3. doGet(e) í•¨ìˆ˜ì—ì„œ ContentService.createTextOutput(
     e.parameter.callback + '(' + JSON.stringify(result) + ')'
   ).setMimeType(ContentService.MimeType.JAVASCRIPT) í˜•íƒœë¡œ ë°˜í™˜í•´ì•¼ í•¨
4. ì‘ë‹µ JSONì— { status: "success" } ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
5. ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ê¶Œí•œ: Apps Scriptê°€ í•´ë‹¹ ì‹œíŠ¸ì— ì ‘ê·¼ ê¶Œí•œì´ ìˆì–´ì•¼ í•¨
-->
</body>
</html>



