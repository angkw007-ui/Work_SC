<div class="container">
    <h2>공용 업무 스케줄러</h2>
    <form id="scheduleForm">
        <div class="form-group">
            <label>공문번호</label>
            <input type="text" name="docNum" placeholder="예: 2024-001" required>
        </div>
        <div class="form-group">
            <label>공문제목</label>
            <input type="text" name="title" placeholder="업무명을 입력하세요" required>
        </div>
        <div class="form-group">
            <label>제출마감일 (정렬 기준)</label>
            <input type="date" name="dueDate" required>
        </div>
        <div class="form-group">
            <label>비고</label>
            <textarea name="memo" placeholder="추가 메모"></textarea>
        </div>
        <button type="submit" id="submitBtn">스케줄 등록</button>
    </form>
    <div id="status"></div>
</div>

<script>
    const scriptURL = 'YOUR_NEW_DEPLOY_URL'; // 배포 후 새로 받은 URL로 교체
    const form = document.getElementById('scheduleForm');
    const status = document.getElementById('status');

    form.addEventListener('submit', e => {
        e.preventDefault();
        const btn = document.getElementById('submitBtn');
        btn.disabled = true;
        status.innerText = '등록 중...';

        const formData = new FormData(form);
        const data = {};
        formData.forEach((value, key) => data[key] = value);

        fetch(scriptURL, {
            method: 'POST',
            mode: 'no-cors',
            body: JSON.stringify(data)
        })
        .then(() => {
            status.innerText = '등록 완료! 시트에서 마감일을 확인하세요.';
            status.style.color = 'green';
            form.reset();
            btn.disabled = false;
        })
        .catch(() => {
            status.innerText = '오류가 발생했습니다.';
            status.style.color = 'red';
            btn.disabled = false;
        });
    });
</script>
